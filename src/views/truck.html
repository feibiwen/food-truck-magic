{% extends 'boilerplate.html' %}

{% block title %}{{ truck.name }}{% endblock %}

{% block stylesheets %}
    {% parent %}
    <link rel="stylesheet" href="/styles/truck.css" />
    <style type="text/css">
        #map-canvas {
            height: 600px;
        }
    </style>
{% endblock %}

{% block scripts %}
    {% parent %}
    <script type="text/javascript" src="/js/truck.js"></script>

    {% if user %}
    <script type="text/javascript">
        var foodTruckNS = foodTruckNS || {};
        foodTruckNS.truck = foodTruckNS.truck || {};
        foodTruckNS.truck.favoriting = {{following}};
        foodTruckNS.truck.truckid = {{truck.id}};
        foodTruckNS.truck.userid = {{user.id}};
        $(function() {
            foodTruckNS.truck.init();
        });
    </script>
    {% endif %}

    {% if truck.open %}
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA0uRmvgWbp3WBxVaCqf1WkZpu5nSibMpc&sensor=false"></script>

    <script type="text/javascript" src="/js/mapview.js"> </script>
    <script type="text/javascript">
        $(function() {
            var initData = {
                zoomLevel: 14,
                truckId: {{truck.id}} 
            };
            foodTruckNS.mapview.init(initData);
        });
    </script>
    {% endif %}

{% endblock %}

{% block content %}

<div id="truck-sidebar">
	<div id="prof-pic">
		<img width="{{ profPicSize }}" 
			 height="{{ profPicSize }}"
			{% if profPic %}
				 src="{{ profPic.profPicThumb }}"
			{% else %}
				 src="/images/default-truck.jpg"
			{% endif %}
			alt="{{ truck.name }}"
		/>
	</div>

	<ul id="truck-data">
		{% if truck.phone %}
			<li class="data-item phone">
				Phone: <a href="tel:{{ truck.phone }}">{{ truck.phone }}</a>
			</li>
		{% endif %}
		{% if truck.website %}
			<li class="data-item website">
				Website: <a href="{{ truck.website }}" class="truck-website">{{ truck.website }}</a>
			</li>
		{% endif %}

		{% if user %}
			<li>
				<button type="button" id="favorite" style="display:none;"></button>
			</li>
		{% else %}
			<li>
				(Log in to favorite this truck)
			</li>
		{% endif %}
		<li>
		{{ truck.description|default("No Description Available!") }}
		</li>

		{#
		{% if photos %}
		<div class="photo-preview">
		{% for photo in photos %}
		<div class="photo">
			<img src="{{ photo.thumb }}" width="{{ photoThumbSize }}" height="{{ photoThumbSize }}" />
		</div>
		{% endfor %}
		</div>
		{% endif %}
		#}
	</ul>
</div>

<div id="truck-content">
	<h2>
		{{ truck.name }}
		
		{% if truck.id == my_truck_id %} 
			<span class="info"> This is your truck! </span>
		{%endif%} 
		<span class="info">
		{% if truck.open %} 
			(open!) 
		{% else %} 
			(closed) 
		{%endif%}
		</span>
	</h2>
</div>

{% if truck.open %}
    <div id="map-canvas"></div>
{% endif %}


{% endblock %}
